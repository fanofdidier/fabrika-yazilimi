{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AutoComplete=_ref=>{let{value,onChange,placeholder=\"Ürün adı yazın...\",onProductSelect,className=\"\",error=null}=_ref;const[suggestions,setSuggestions]=useState([]);const[isLoading,setIsLoading]=useState(false);const[showSuggestions,setShowSuggestions]=useState(false);const[selectedIndex,setSelectedIndex]=useState(-1);const inputRef=useRef(null);const suggestionsRef=useRef(null);const debounceRef=useRef(null);// Debounced search function\nconst searchProducts=async query=>{if(query.length<2){setSuggestions([]);return;}setIsLoading(true);try{const response=await api.get(\"/products/search?q=\".concat(encodeURIComponent(query),\"&limit=8\"));if(response.data.success){setSuggestions(response.data.data.products);}}catch(error){console.error('Ürün arama hatası:',error);setSuggestions([]);}finally{setIsLoading(false);}};// Handle input change\nconst handleInputChange=e=>{const newValue=e.target.value;onChange(newValue);// Clear previous debounce\nif(debounceRef.current){clearTimeout(debounceRef.current);}// Set new debounce\ndebounceRef.current=setTimeout(()=>{searchProducts(newValue);},300);setShowSuggestions(true);setSelectedIndex(-1);};// Handle suggestion selection\nconst handleSuggestionSelect=product=>{onChange(product.name);setShowSuggestions(false);setSelectedIndex(-1);if(onProductSelect){onProductSelect(product);}};// Handle keyboard navigation\nconst handleKeyDown=e=>{if(!showSuggestions||suggestions.length===0)return;switch(e.key){case'ArrowDown':e.preventDefault();setSelectedIndex(prev=>prev<suggestions.length-1?prev+1:prev);break;case'ArrowUp':e.preventDefault();setSelectedIndex(prev=>prev>0?prev-1:-1);break;case'Enter':e.preventDefault();if(selectedIndex>=0&&selectedIndex<suggestions.length){handleSuggestionSelect(suggestions[selectedIndex]);}break;case'Escape':setShowSuggestions(false);setSelectedIndex(-1);break;default:// Do nothing for other keys\nbreak;}};// Handle click outside\nuseEffect(()=>{const handleClickOutside=event=>{if(suggestionsRef.current&&!suggestionsRef.current.contains(event.target)&&inputRef.current&&!inputRef.current.contains(event.target)){setShowSuggestions(false);setSelectedIndex(-1);}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[]);// Cleanup debounce on unmount\nuseEffect(()=>{return()=>{if(debounceRef.current){clearTimeout(debounceRef.current);}};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,type:\"text\",value:value,onChange:handleInputChange,onKeyDown:handleKeyDown,onFocus:()=>setShowSuggestions(true),placeholder:placeholder,className:\"\\n          w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\\n          \".concat(error?'border-red-500':'border-gray-300',\"\\n          \").concat(className,\"\\n        \"),autoComplete:\"off\"}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-3 top-1/2 transform -translate-y-1/2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500\"})}),showSuggestions&&suggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{ref:suggestionsRef,className:\"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\",children:suggestions.map((product,index)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleSuggestionSelect(product),className:\"\\n                px-3 py-2 cursor-pointer hover:bg-gray-100 flex items-center justify-between\\n                \".concat(index===selectedIndex?'bg-blue-50':'',\"\\n              \"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900\",children:product.name}),product.description&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:product.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded\",children:product.category}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-blue-600\",children:[product.usageCount,\" kez kullan\\u0131ld\\u0131\"]})]})]},product._id))}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:error})]});};export default AutoComplete;","map":{"version":3,"names":["React","useState","useEffect","useRef","api","jsx","_jsx","jsxs","_jsxs","AutoComplete","_ref","value","onChange","placeholder","onProductSelect","className","error","suggestions","setSuggestions","isLoading","setIsLoading","showSuggestions","setShowSuggestions","selectedIndex","setSelectedIndex","inputRef","suggestionsRef","debounceRef","searchProducts","query","length","response","get","concat","encodeURIComponent","data","success","products","console","handleInputChange","e","newValue","target","current","clearTimeout","setTimeout","handleSuggestionSelect","product","name","handleKeyDown","key","preventDefault","prev","handleClickOutside","event","contains","document","addEventListener","removeEventListener","children","ref","type","onKeyDown","onFocus","autoComplete","map","index","onClick","description","category","usageCount","_id"],"sources":["/Users/hakankarahan/Desktop/fabrikayazilimi/frontend/src/components/UI/AutoComplete.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport api from '../../services/api';\n\nconst AutoComplete = ({ \n  value, \n  onChange, \n  placeholder = \"Ürün adı yazın...\", \n  onProductSelect,\n  className = \"\",\n  error = null \n}) => {\n  const [suggestions, setSuggestions] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  \n  const inputRef = useRef(null);\n  const suggestionsRef = useRef(null);\n  const debounceRef = useRef(null);\n\n  // Debounced search function\n  const searchProducts = async (query) => {\n    if (query.length < 2) {\n      setSuggestions([]);\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await api.get(`/products/search?q=${encodeURIComponent(query)}&limit=8`);\n      if (response.data.success) {\n        setSuggestions(response.data.data.products);\n      }\n    } catch (error) {\n      console.error('Ürün arama hatası:', error);\n      setSuggestions([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Handle input change\n  const handleInputChange = (e) => {\n    const newValue = e.target.value;\n    onChange(newValue);\n\n    // Clear previous debounce\n    if (debounceRef.current) {\n      clearTimeout(debounceRef.current);\n    }\n\n    // Set new debounce\n    debounceRef.current = setTimeout(() => {\n      searchProducts(newValue);\n    }, 300);\n\n    setShowSuggestions(true);\n    setSelectedIndex(-1);\n  };\n\n  // Handle suggestion selection\n  const handleSuggestionSelect = (product) => {\n    onChange(product.name);\n    setShowSuggestions(false);\n    setSelectedIndex(-1);\n    \n    if (onProductSelect) {\n      onProductSelect(product);\n    }\n  };\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e) => {\n    if (!showSuggestions || suggestions.length === 0) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setSelectedIndex(prev => \n          prev < suggestions.length - 1 ? prev + 1 : prev\n        );\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setSelectedIndex(prev => prev > 0 ? prev - 1 : -1);\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < suggestions.length) {\n          handleSuggestionSelect(suggestions[selectedIndex]);\n        }\n        break;\n      case 'Escape':\n        setShowSuggestions(false);\n        setSelectedIndex(-1);\n        break;\n      default:\n        // Do nothing for other keys\n        break;\n    }\n  };\n\n  // Handle click outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (\n        suggestionsRef.current && \n        !suggestionsRef.current.contains(event.target) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target)\n      ) {\n        setShowSuggestions(false);\n        setSelectedIndex(-1);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Cleanup debounce on unmount\n  useEffect(() => {\n    return () => {\n      if (debounceRef.current) {\n        clearTimeout(debounceRef.current);\n      }\n    };\n  }, []);\n\n  return (\n    <div className=\"relative\">\n      <input\n        ref={inputRef}\n        type=\"text\"\n        value={value}\n        onChange={handleInputChange}\n        onKeyDown={handleKeyDown}\n        onFocus={() => setShowSuggestions(true)}\n        placeholder={placeholder}\n        className={`\n          w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\n          ${error ? 'border-red-500' : 'border-gray-300'}\n          ${className}\n        `}\n        autoComplete=\"off\"\n      />\n      \n      {/* Loading indicator */}\n      {isLoading && (\n        <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2\">\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500\"></div>\n        </div>\n      )}\n\n      {/* Suggestions dropdown */}\n      {showSuggestions && suggestions.length > 0 && (\n        <div\n          ref={suggestionsRef}\n          className=\"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\"\n        >\n          {suggestions.map((product, index) => (\n            <div\n              key={product._id}\n              onClick={() => handleSuggestionSelect(product)}\n              className={`\n                px-3 py-2 cursor-pointer hover:bg-gray-100 flex items-center justify-between\n                ${index === selectedIndex ? 'bg-blue-50' : ''}\n              `}\n            >\n              <div className=\"flex-1\">\n                <div className=\"font-medium text-gray-900\">{product.name}</div>\n                {product.description && (\n                  <div className=\"text-sm text-gray-500\">{product.description}</div>\n                )}\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <span className=\"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded\">\n                  {product.category}\n                </span>\n                <span className=\"text-xs text-blue-600\">\n                  {product.usageCount} kez kullanıldı\n                </span>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Error message */}\n      {error && (\n        <p className=\"mt-1 text-sm text-red-600\">{error}</p>\n      )}\n    </div>\n  );\n};\n\nexport default AutoComplete;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}