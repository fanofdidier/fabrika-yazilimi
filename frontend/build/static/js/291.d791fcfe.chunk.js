"use strict";(self.webpackChunkfabrika_magaza_frontend=self.webpackChunkfabrika_magaza_frontend||[]).push([[291],{6291:(e,a,r)=>{r.r(a),r.d(a,{default:()=>o});var t=r(5043),i=r(5475),l=r(749),s=r(7026),n=r(6305),d=r(579);const o=()=>{const{hasRole:e,user:a}=(0,s.As)(),[r,o]=(0,t.useState)([]),[c,m]=(0,t.useState)(!0),[u,x]=(0,t.useState)(""),[v,p]=(0,t.useState)("all"),[h,g]=(0,t.useState)("all"),y="fabrika_iscisi"===(null===a||void 0===a?void 0:a.role);(0,t.useEffect)(()=>{(async()=>{if(a){m(!0);try{let a=[];try{var e,r,t;const i=await n.Ay.get("/orders");a=null!==(e=i.data)&&void 0!==e&&e.success&&null!==(r=i.data)&&void 0!==r&&null!==(t=r.data)&&void 0!==t&&t.orders?i.data.data.orders:[]}catch(i){console.warn("Backend orders fetch failed, continue with local orders only.",null===i||void 0===i?void 0:i.message),a=[]}const l=a.map((e,a)=>{const r=e.createdAt||(new Date).toISOString(),t=e.orderNumber||"WEB-".concat(new Date(r).getFullYear(),"-").concat(String(a+1).padStart(3,"0")),i=e.items&&e.items.length>0?e.items[0].productName:e.title||"\xdcr\xfcn",l=e.createdBy&&e.createdBy.firstName?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName||"").trim():e.createdBy&&e.createdBy.username?e.createdBy.username:"M\xfc\u015fteri",s=e.items&&e.items.length>0?e.items[0].quantity:0,n=e.dueDate||e.deliveryDate||null,d=e.orderDate||r,o=e.status||"beklemede",c=e.priority||"normal";return{id:e._id,_id:e._id,orderNumber:t,product:i,productName:i,customerName:l,quantity:s,unitPrice:0,totalAmount:0,deliveryDate:n,orderDate:d,status:o,priority:c,createdAt:r,source:"backend",title:e.title,description:e.description,location:e.location,assignedTo:e.assignedTo,items:e.items,createdBy:e.createdBy,updatedAt:e.updatedAt}});o(l),await new Promise(e=>setTimeout(e,300))}catch(l){console.error("Orders loading error:",l),o([])}finally{m(!1)}}})()},[a]);const j=e=>{const a={beklemede:{variant:"warning",text:"Beklemede"},onaylandi:{variant:"primary",text:"Onayland\u0131"},hazirlaniyor:{variant:"primary",text:"Haz\u0131rlan\u0131yor"},ham_madde_bekleniyor:{variant:"warning",text:"Ham Madde Bekleniyor"},uretimde:{variant:"primary",text:"\xdcretimde"},kalite_kontrol:{variant:"info",text:"Kalite Kontrol"},paketleniyor:{variant:"primary",text:"Paketleniyor"},kargoya_verildi:{variant:"info",text:"Kargoya Verildi"},teslim_edildi:{variant:"success",text:"Teslim Edildi"},iptal_edildi:{variant:"danger",text:"\u0130ptal Edildi"},pending:{variant:"warning",text:"Beklemede"},in_progress:{variant:"primary",text:"\u0130\u015flemde"},completed:{variant:"success",text:"Tamamland\u0131"},cancelled:{variant:"danger",text:"\u0130ptal Edildi"}}[e]||{variant:"secondary",text:e};return(0,d.jsx)(l.Ex,{variant:a.variant,children:a.text})},N=e=>{const a={"d\xfc\u015f\xfck":{variant:"success",text:"D\xfc\u015f\xfck"},normal:{variant:"warning",text:"Normal"},"y\xfcksek":{variant:"danger",text:"Y\xfcksek"},acil:{variant:"danger",text:"Acil"},low:{variant:"success",text:"D\xfc\u015f\xfck"},medium:{variant:"warning",text:"Orta"},high:{variant:"danger",text:"Y\xfcksek"}}[e]||{variant:"secondary",text:e};return(0,d.jsx)(l.Ex,{variant:a.variant,size:"sm",children:a.text})},k=e=>new Date(e).toLocaleDateString("tr-TR"),b=r.filter(e=>{var a,r,t;if(!e)return!1;const i=(null===(a=e.orderNumber)||void 0===a?void 0:a.toLowerCase().includes(u.toLowerCase()))||(null===(r=e.customerName)||void 0===r?void 0:r.toLowerCase().includes(u.toLowerCase()))||(null===(t=e.product||e.productName)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())),l="all"===v||e.status===v;return i&&l}),f=[{key:"orderNumber",header:y?"G\xf6rev No":"Sipari\u015f No",render:(e,a,r)=>(0,d.jsx)(i.N_,{to:"/orders/".concat((null===a||void 0===a?void 0:a.id)||""),className:"text-blue-600 hover:text-blue-800 font-medium",children:(null===a||void 0===a?void 0:a.orderNumber)||"N/A"})},{key:"customerName",header:"M\xfc\u015fteri",render:(e,a,r)=>(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"font-medium text-gray-900",children:(null===a||void 0===a?void 0:a.customerName)||"Bilinmeyen M\xfc\u015fteri"}),(0,d.jsx)("div",{className:"text-sm text-gray-500",children:(null===a||void 0===a?void 0:a.customerEmail)||"-"})]})},{key:"product",header:"\xdcr\xfcn",render:(e,a,r)=>(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"font-medium text-gray-900",children:(null===a||void 0===a?void 0:a.product)||(null===a||void 0===a?void 0:a.productName)||"Bilinmeyen \xdcr\xfcn"}),(0,d.jsxs)("div",{className:"text-sm text-gray-500",children:["Adet: ",(null===a||void 0===a?void 0:a.quantity)||0]})]})},{key:"status",header:"Durum",render:(e,a,r)=>(0,d.jsxs)("div",{className:"space-y-1",children:[j((null===a||void 0===a?void 0:a.status)||"pending"),N((null===a||void 0===a?void 0:a.priority)||"medium")]})},{key:"dates",header:"Tarihler",render:(e,a,r)=>(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsxs)("div",{children:["Sipari\u015f: ",null!==a&&void 0!==a&&a.orderDate?k(a.orderDate):"-"]}),(0,d.jsxs)("div",{className:"text-gray-500",children:["Teslimat: ",null!==a&&void 0!==a&&a.deliveryDate?k(a.deliveryDate):"-"]})]})},{key:"totalAmount",header:"Tutar",render:(e,a,r)=>{return(0,d.jsx)("div",{className:"font-medium text-gray-900",children:(t=(null===a||void 0===a?void 0:a.totalAmount)||0,new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(t))});var t}},{key:"actions",header:"\u0130\u015flemler",render:(e,a,r)=>(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsx)(i.N_,{to:"/orders/".concat((null===a||void 0===a?void 0:a.id)||""),className:"inline-block",children:(0,d.jsx)(l.$n,{size:"sm",variant:"outline",children:"G\xf6r\xfcnt\xfcle"})}),"pending"===(null===a||void 0===a?void 0:a.status)&&(0,d.jsx)(l.$n,{size:"sm",variant:"primary",children:"Ba\u015flat"})]})}],_=r.reduce((e,a)=>{if(null!==a&&void 0!==a&&a.status){let r=a.status;r={beklemede:"pending",onaylandi:"pending",hazirlaniyor:"in_progress",ham_madde_bekleniyor:"in_progress",uretimde:"in_progress",kalite_kontrol:"in_progress",paketleniyor:"in_progress",kargoya_verildi:"in_progress",teslim_edildi:"completed",iptal_edildi:"cancelled"}[a.status]||a.status,e[r]=(e[r]||0)+1}return e},{});return c?(0,d.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,d.jsx)(l.kt,{size:"lg",text:"Sipari\u015fler y\xfckleniyor..."})}):(0,d.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:y?"G\xf6revlerim":"Sipari\u015f Y\xf6netimi"}),(0,d.jsx)("p",{className:"text-gray-600 mt-2",children:"Toplam ".concat(r.length,y?" g\xf6rev bulundu":" sipari\u015f bulundu")})]}),e(["admin","magaza_personeli"])&&(0,d.jsx)(i.N_,{to:"/orders/new",children:(0,d.jsx)(l.$n,{variant:"primary",children:"\ud83d\udce6 Yeni Sipari\u015f Olu\u015ftur"})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,d.jsx)(l.Zp,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg mr-3",children:(0,d.jsx)("span",{className:"text-yellow-600 text-xl",children:"\u23f3"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:y?"Devam Eden G\xf6revler":"Beklemede"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.pending||0})]})]})}),(0,d.jsx)(l.Zp,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:(0,d.jsx)("span",{className:"text-blue-600 text-xl",children:"\ud83d\udd04"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:y?"Devam Eden G\xf6revler":"\u0130\u015flemde"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.in_progress||0})]})]})}),(0,d.jsx)(l.Zp,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"p-2 bg-green-100 rounded-lg mr-3",children:(0,d.jsx)("span",{className:"text-green-600 text-xl",children:"\u2705"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Tamamland\u0131"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.completed||0})]})]})}),(0,d.jsx)(l.Zp,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"p-2 bg-red-100 rounded-lg mr-3",children:(0,d.jsx)("span",{className:"text-red-600 text-xl",children:"\u274c"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"\u0130ptal Edildi"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.cancelled||0})]})]})})]}),(0,d.jsx)(l.Zp,{className:"p-4 mb-6",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsx)(l.pd,{placeholder:y?"G\xf6rev no, m\xfc\u015fteri ad\u0131 veya \xfcr\xfcn ara...":"Sipari\u015f no, m\xfc\u015fteri ad\u0131 veya \xfcr\xfcn ara...",value:u,onChange:e=>x(e.target.value)}),(0,d.jsx)("select",{value:v,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"all",label:"T\xfcm Durumlar"},{value:"pending",label:"Beklemede"},{value:"in_progress",label:"\u0130\u015flemde"},{value:"completed",label:"Tamamland\u0131"},{value:"cancelled",label:"\u0130ptal Edildi"}].map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,d.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"T\xfcm \xd6ncelikler"}),(0,d.jsx)("option",{value:"high",children:"Y\xfcksek"}),(0,d.jsx)("option",{value:"medium",children:"Orta"}),(0,d.jsx)("option",{value:"low",children:"D\xfc\u015f\xfck"})]})]})}),(0,d.jsx)(l.Zp,{children:(0,d.jsx)(l.XI,{columns:f,data:b})})]})}}}]);
//# sourceMappingURL=291.d791fcfe.chunk.js.map