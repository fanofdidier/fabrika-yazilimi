"use strict";(self.webpackChunkfabrika_magaza_frontend=self.webpackChunkfabrika_magaza_frontend||[]).push([[453],{3453:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var a=r(2555),n=r(5043),s=r(3216),i=r(5475),l=r(749),o=r(3986);const c=["title","titleId"];function d(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,c);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const m=n.forwardRef(d),u=["title","titleId"];function x(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,u);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const g=n.forwardRef(x),h=["title","titleId"];function p(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,h);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const f=n.forwardRef(p),v=["title","titleId"];function y(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,v);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const j=n.forwardRef(y),b=["title","titleId"];function N(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,b);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const k=n.forwardRef(N),w=["title","titleId"];function S(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,w);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const A=n.forwardRef(S);var E=r(579);const R=e=>{let{onRecordingComplete:t,onRecordingDelete:r,initialAudioUrl:a=null}=e;const[s,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(0),[u,x]=(0,n.useState)(a),[h,p]=(0,n.useState)(!!a),v=(0,n.useRef)(null),y=(0,n.useRef)(null),b=(0,n.useRef)(null),N=(0,n.useRef)([]);(0,n.useEffect)(()=>()=>{b.current&&clearInterval(b.current),u&&u.startsWith("blob:")&&URL.revokeObjectURL(u)},[u]);return(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsx)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border",children:(0,E.jsx)("div",{className:"flex items-center space-x-4",children:h?(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("button",{onClick:()=>{y.current&&(l?(y.current.pause(),o(!1)):(y.current.play(),o(!0)))},className:"flex items-center space-x-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:l?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(f,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Duraklat"})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(j,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Oynat"})]})}),(0,E.jsxs)("button",{onClick:()=>{u&&u.startsWith("blob:")&&URL.revokeObjectURL(u),x(null),p(!1),d(0),r()},className:"flex items-center space-x-2 px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[(0,E.jsx)(k,{className:"w-4 h-4"}),(0,E.jsx)("span",{children:"Sil"})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,E.jsx)(A,{className:"w-4 h-4"}),(0,E.jsx)("span",{className:"text-sm",children:"Ses kayd\u0131 mevcut"})]})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("button",{onClick:s?()=>{v.current&&s&&(v.current.stop(),i(!1),b.current&&clearInterval(b.current))}:async()=>{try{let e;if(console.log("\ud83c\udfa4 Mikrofon eri\u015fimi isteniyor..."),console.log("\ud83c\udfa4 navigator.mediaDevices:",navigator.mediaDevices),console.log("\ud83c\udfa4 navigator.getUserMedia:",navigator.getUserMedia),console.log("\ud83c\udfa4 window.location.protocol:",window.location.protocol),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)e=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices),console.log("\ud83c\udfa4 Modern MediaDevices API kullan\u0131l\u0131yor");else{if(!navigator.getUserMedia)throw new Error("Bu taray\u0131c\u0131 mikrofon eri\u015fimini desteklemiyor. HTTPS gerekiyor olabilir.");e=e=>new Promise((t,r)=>{navigator.getUserMedia(e,t,r)}),console.log("\ud83c\udfa4 Eski getUserMedia API kullan\u0131l\u0131yor")}const r=await e({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});console.log("\ud83c\udfa4 Mikrofon eri\u015fimi ba\u015far\u0131l\u0131:",r),console.log("\ud83c\udfa4 Stream tracks:",r.getTracks());const a=new MediaRecorder(r);v.current=a,N.current=[],a.ondataavailable=e=>{e.data.size>0&&N.current.push(e.data)},a.onstop=()=>{const e=new Blob(N.current,{type:"audio/webm"}),a=URL.createObjectURL(e);x(a),p(!0),t(e),r.getTracks().forEach(e=>e.stop())},a.start(),i(!0),d(0),b.current=setInterval(()=>{d(e=>e+1)},1e3)}catch(e){console.error("\ud83c\udfa4 Mikrofon eri\u015fim hatas\u0131:",e),console.error("\ud83c\udfa4 Hata detay\u0131:",{name:e.name,message:e.message,constraint:e.constraint});let t="Mikrofon eri\u015fimi i\xe7in izin verilmedi. ";"NotAllowedError"===e.name?t+="L\xfctfen taray\u0131c\u0131 ayarlar\u0131ndan mikrofon iznini etkinle\u015ftirin.":"NotFoundError"===e.name?t+="Mikrofon bulunamad\u0131. L\xfctfen mikrofonunuzun ba\u011fl\u0131 oldu\u011fundan emin olun.":"NotSupportedError"===e.name?t+="Bu taray\u0131c\u0131 mikrofon eri\u015fimini desteklemiyor.":e.message.includes("HTTPS")?t+="HTTPS ba\u011flant\u0131s\u0131 gerekiyor. L\xfctfen https://localhost:3000 adresini kullan\u0131n.":t+="Hata: ".concat(e.message),alert(t)}},className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat(s?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"),children:s?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(m,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:"Kayd\u0131 Durdur"})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(g,{className:"w-5 h-5"}),(0,E.jsx)("span",{children:"Kay\u0131t Ba\u015flat"})]})}),s&&(0,E.jsxs)("div",{className:"flex items-center space-x-2 text-red-600",children:[(0,E.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),(0,E.jsx)("span",{className:"font-mono text-sm",children:(e=>{const t=Math.floor(e/60),r=e%60;return"".concat(t,":").concat(r.toString().padStart(2,"0"))})(c)})]})]})})}),h&&(0,E.jsx)("audio",{ref:y,src:u,onEnded:()=>{o(!1)},className:"hidden"}),s&&(0,E.jsx)("div",{className:"text-center text-sm text-gray-600",children:(0,E.jsx)("p",{children:"\ud83c\udfa4 Ses kayd\u0131 yap\u0131l\u0131yor... Konu\u015fmaya ba\u015flayabilirsiniz."})})]})},L=["title","titleId"];function C(e,t){let{title:r,titleId:a}=e,s=(0,o.A)(e,L);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const M=n.forwardRef(C),I=e=>{let{voiceRecording:t,userName:r,timestamp:a}=e;const[s,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(0),[c,d]=(0,n.useState)(0),m=(0,n.useRef)(null);console.log("\ud83c\udfa4 VoicePlayer rendered with:",{voiceRecording:t,userName:r,timestamp:a});const u=t&&t.filename?"http://192.168.1.101:5001/uploads/voice-recordings/".concat(t.filename):null;if(console.log("\ud83c\udfa4 Audio URL:",u),(0,n.useEffect)(()=>{if(m.current&&u){console.log("\ud83c\udfa4 Loading audio with URL:",u),m.current.pause(),m.current.currentTime=0,m.current.src=u;const e=()=>console.log("\ud83c\udfa4 Audio load started"),t=()=>console.log("\ud83c\udfa4 Audio can play"),r=e=>console.error("\ud83c\udfa4 Audio load error:",e);return m.current.addEventListener("loadstart",e),m.current.addEventListener("canplay",t),m.current.addEventListener("error",r),m.current.load(),()=>{m.current&&(m.current.removeEventListener("loadstart",e),m.current.removeEventListener("canplay",t),m.current.removeEventListener("error",r))}}},[u]),!u)return console.log("\ud83c\udfa4 No audio URL, not rendering VoicePlayer"),null;const x=e=>{if(isNaN(e))return"0:00";const t=Math.floor(e/60),r=Math.floor(e%60);return"".concat(t,":").concat(r.toString().padStart(2,"0"))};return t&&u?(0,E.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-3",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)(A,{className:"w-5 h-5 text-blue-600"}),(0,E.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"\ud83c\udfa4 Ses Kayd\u0131"})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-500",children:(e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB"][t]})(t.size)}),(0,E.jsx)("button",{onClick:()=>{if(u){const e=document.createElement("a");e.href=u,e.download=t.originalName||"voice-recording.webm",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},className:"text-gray-500 hover:text-gray-700 transition-colors",title:"Ses dosyas\u0131n\u0131 indir",children:(0,E.jsx)(M,{className:"w-4 h-4"})})]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,E.jsx)("button",{onClick:()=>{var e,t;console.log("\ud83c\udfa4 Toggle play clicked, audioRef.current:",m.current),console.log("\ud83c\udfa4 Audio src:",null===(e=m.current)||void 0===e?void 0:e.src),console.log("\ud83c\udfa4 Audio readyState:",null===(t=m.current)||void 0===t?void 0:t.readyState),m.current&&(s?(console.log("\ud83c\udfa4 Pausing audio"),m.current.pause(),i(!1)):(console.log("\ud83c\udfa4 Playing audio"),m.current.play().then(()=>{console.log("\ud83c\udfa4 Audio play started successfully"),i(!0)}).catch(e=>{console.error("\ud83c\udfa4 Audio play failed:",e)})))},className:"flex items-center justify-center w-10 h-10 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors",children:s?(0,E.jsx)(f,{className:"w-5 h-5"}):(0,E.jsx)(j,{className:"w-5 h-5 ml-0.5"})}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,E.jsx)("span",{className:"text-xs text-gray-600",children:x(c)}),(0,E.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-1",children:(0,E.jsx)("div",{className:"bg-blue-500 h-1 rounded-full transition-all duration-100",style:{width:l>0?"".concat(c/l*100,"%"):"0%"}})}),(0,E.jsx)("span",{className:"text-xs text-gray-600",children:x(l)})]}),(0,E.jsxs)("div",{className:"text-xs text-gray-500",children:[r," taraf\u0131ndan kaydedildi \u2022 ",new Date(a).toLocaleString("tr-TR")]})]})]}),(0,E.jsx)("audio",{ref:m,src:u,onEnded:()=>{i(!1),d(0)},onLoadedMetadata:()=>{m.current&&o(m.current.duration)},onTimeUpdate:()=>{m.current&&d(m.current.currentTime)},preload:"metadata",crossOrigin:"anonymous"})]}):null};var D=r(7026),B=r(6471),T=r(186),U=r(6305);const z=()=>{const{id:e}=(0,s.g)(),{user:t}=(0,D.As)(),{fetchNotifications:r}=(0,B.hN)(),{socket:o,connected:c}=(0,T.FO)(),[d,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(!0),[g,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)({}),[v,y]=(0,n.useState)(""),[j,b]=(0,n.useState)(""),[N,k]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[A,L]=(0,n.useState)(!1),C=t&&("admin"===t.role||"manager"===t.role),M=e=>{if(!e)return"-";return new Date(e).toLocaleDateString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},z=async()=>{try{x(!0);const t=(await U.Ay.get("/orders/".concat(e))).data.data.order,r=(0,a.A)((0,a.A)({},t),{},{timeline:t.timeline||[{id:1,type:"created",description:"Sipari\u015f sisteme kaydedildi",timestamp:t.createdAt,user:t.createdBy?"".concat(t.createdBy.firstName||""," ").concat(t.createdBy.lastName||"").trim()||t.createdBy.username:"Sistem"}],responses:t.responses||[]});m(r),f(r),console.log("\ud83c\udfa4 Order timeline data:",r.timeline);const n=r.timeline.filter(e=>e.voiceRecording);console.log("\ud83c\udfa4 Timeline entries with voice recording:",n)}catch(t){console.error("Order load error:",t)}finally{x(!1)}};(0,n.useEffect)(()=>{z()},[e]),(0,n.useEffect)(()=>{if(console.log("Socket useEffect \xe7al\u0131\u015ft\u0131:",{socket:!!o,connected:c,id:e,socketId:null===o||void 0===o?void 0:o.id,socketConnected:null===o||void 0===o?void 0:o.connected}),o){console.log("Socket event listener'lar\u0131 ekleniyor...");const t=t=>{console.log("\ud83d\udd14 orderUpdated event al\u0131nd\u0131:",t),console.log("\ud83d\udd0d Kar\u015f\u0131la\u015ft\u0131rma:",{receivedId:t.orderId,currentId:e,match:t.orderId===e}),t.orderId===e?(console.log("\u2705 Sipari\u015f g\xfcncellendi, sayfa yenileniyor:",t),z(),r()):console.log("\u274c Farkl\u0131 sipari\u015f ID'si, g\xfcncelleme yap\u0131lm\u0131yor")},a=e=>{console.log("\ud83d\udd14 newNotification event al\u0131nd\u0131:",e),r()};return o.on("orderUpdated",t),o.on("newNotification",a),()=>{console.log("Socket event listener'lar\u0131 temizleniyor..."),o.off("orderUpdated",t),o.off("newNotification",a)}}console.log("Socket event listener'lar\u0131 eklenmedi - socket yok:",{socket:!!o,connected:c,socketConnected:null===o||void 0===o?void 0:o.connected})},[o,e]),(0,n.useEffect)(()=>{if(console.log("Alternatif Socket useEffect \xe7al\u0131\u015ft\u0131:",{socket:!!o,connected:c,id:e,socketId:null===o||void 0===o?void 0:o.id,socketConnected:null===o||void 0===o?void 0:o.connected}),o){console.log("Alternatif Socket event listener'lar\u0131 ekleniyor...");const t=t=>{console.log("Alternatif orderUpdated event al\u0131nd\u0131:",t),console.log("Alternatif Kar\u015f\u0131la\u015ft\u0131rma:",{receivedId:t.orderId,currentId:e,match:t.orderId===e}),t.orderId===e&&(console.log("Alternatif Sipari\u015f g\xfcncellendi, sayfa yenileniyor:",t),z(),r())},a=e=>{console.log("Alternatif newNotification event al\u0131nd\u0131:",e),r()};return o.on("orderUpdated",t),o.on("newNotification",a),()=>{console.log("Alternatif Socket event listener'lar\u0131 temizleniyor..."),o.off("orderUpdated",t),o.off("newNotification",a)}}},[e]);return u?(0,E.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,E.jsx)(l.kt,{size:"lg",text:"Sipari\u015f detaylar\u0131 y\xfckleniyor..."})}):d?(0,E.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,E.jsxs)("div",{className:"mb-8",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Sipari\u015f Detay\u0131"}),(0,E.jsxs)("p",{className:"text-gray-600 mt-2",children:["Sipari\u015f #",d.orderNumber||e]})]}),(0,E.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,E.jsx)(i.N_,{to:"/orders",children:(0,E.jsx)(l.$n,{variant:"secondary",children:"Geri D\xf6n"})}),C&&(0,E.jsx)("div",{className:"flex space-x-2",children:g?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(l.$n,{variant:"primary",onClick:async()=>{try{await U.Ay.put("/orders/".concat(e),p),await z(),h(!1)}catch(t){console.error("Update error:",t)}},children:"Kaydet"}),(0,E.jsx)(l.$n,{variant:"secondary",onClick:()=>{h(!1),f((0,a.A)({},d))},children:"\u0130ptal"})]}):(0,E.jsx)(l.$n,{variant:"primary",onClick:()=>{h(!0),f((0,a.A)({},d))},children:"D\xfczenle"})})]})]}),(0,E.jsx)("div",{className:"mt-4",children:(0,E.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat("pending"===d.status?"bg-yellow-100 text-yellow-800":"confirmed"===d.status?"bg-green-100 text-green-800":"in_progress"===d.status?"bg-blue-100 text-blue-800":"completed"===d.status?"bg-green-100 text-green-800":"cancelled"===d.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:d.status})})]}),(0,E.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,E.jsx)("div",{className:"lg:col-span-3 space-y-6",children:(0,E.jsxs)(l.Zp,{className:"p-6",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sipari\u015f Bilgileri"}),(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xdcr\xfcn"}),g?(0,E.jsx)(l.pd,{value:p.product,onChange:e=>f((0,a.A)((0,a.A)({},p),{},{product:e.target.value}))}):(0,E.jsx)("p",{className:"text-gray-900",children:d.product||"-"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xdcr\xfcn Kodu"}),(0,E.jsx)("p",{className:"text-gray-900",children:d.productCode||"-"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Miktar"}),g?(0,E.jsx)(l.pd,{type:"number",value:p.quantity,onChange:e=>f((0,a.A)((0,a.A)({},p),{},{quantity:parseInt(e.target.value)}))}):(0,E.jsxs)("p",{className:"text-gray-900",children:[d.quantity||0," adet"]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Birim Fiyat"}),(0,E.jsxs)("p",{className:"text-gray-900",children:["\u20ba",d.unitPrice?d.unitPrice.toFixed(2):"0.00"]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Toplam Tutar"}),(0,E.jsxs)("p",{className:"text-gray-900",children:["\u20ba",d.totalAmount?d.totalAmount.toFixed(2):"0.00"]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teslimat Tarihi"}),(0,E.jsx)("p",{className:"text-gray-900",children:M(d.deliveryDate)})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"A\xe7\u0131klama"}),g?(0,E.jsx)("textarea",{className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3",value:p.description,onChange:e=>f((0,a.A)((0,a.A)({},p),{},{description:e.target.value}))}):(0,E.jsx)("p",{className:"text-gray-900",children:d.description||"-"})]})]})]})}),(0,E.jsx)("div",{className:"lg:col-span-4",children:(0,E.jsxs)(l.Zp,{className:"p-6",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Sipari\u015f Ge\xe7mi\u015fi"}),(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("svg",{className:"w-5 h-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.868 19.718A8.966 8.966 0 003 12a9 9 0 0118 0 8.966 8.966 0 00-1.868 7.718"})}),(0,E.jsx)("span",{className:"text-sm text-gray-600",children:"Ger\xe7ek Zamanl\u0131"})]})]}),(0,E.jsx)("div",{className:"space-y-4",children:(0,E.jsxs)("div",{children:[(0,E.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[(0,E.jsx)("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Sipari\u015f Ge\xe7mi\u015fi"]}),(0,E.jsx)("div",{className:"space-y-3",children:d.timeline&&d.timeline.length>0?d.timeline.map((e,t)=>{const r="admin"===e.user,a=e.voiceRecording&&e.voiceRecording.filename;return a&&console.log("\ud83c\udfa4 Timeline entry with voice recording:",e),(0,E.jsxs)("div",{className:"flex space-x-3 p-3 rounded-lg ".concat(r?"bg-blue-50 border-l-4 border-blue-400":"bg-green-50 border-l-4 border-green-400"),children:[(0,E.jsx)("div",{className:"flex-shrink-0",children:(0,E.jsx)("div",{className:"w-4 h-4 rounded-full flex items-center justify-center ".concat(r?a?"bg-blue-600":"bg-blue-500":a?"bg-green-600":"bg-green-500"),children:a&&e.voiceRecording&&e.voiceRecording.filename?(0,E.jsx)("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,E.jsx)("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})}):(0,E.jsx)("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})})}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsx)("p",{className:"text-sm font-medium ".concat(r?"text-blue-900":"text-green-900"),children:e.description}),(0,E.jsx)("p",{className:"text-xs ".concat(r?"text-blue-600":"text-green-600"),children:M(e.timestamp)}),e.voiceRecording&&e.voiceRecording.filename&&(0,E.jsx)(I,{voiceRecording:e.voiceRecording,userName:e.user,timestamp:e.timestamp})]})]},e.id||t)}):(0,E.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Hen\xfcz ge\xe7mi\u015f kayd\u0131 yok"})})]})})]})}),(0,E.jsxs)("div",{className:"lg:col-span-5",children:[(0,E.jsxs)(l.Zp,{className:"p-6 mb-6",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Durum \u0130\u015flemleri"}),(0,E.jsx)("div",{className:"space-y-3",children:C&&(0,E.jsx)(l.$n,{variant:"danger",className:"w-full",onClick:()=>(async t=>{try{await U.Ay.put("/orders/".concat(e,"/status"),{status:t}),await z()}catch(r){console.error("Status update error:",r);const e=(0,a.A)((0,a.A)({},d),{},{status:t});m(e),f(e);const n={id:d.timeline.length+1,status:t,title:"Durum ".concat(t," olarak g\xfcncellendi"),description:"Sipari\u015f durumu ".concat(t," olarak de\u011fi\u015ftirildi"),timestamp:(new Date).toISOString(),user:"Mevcut Kullan\u0131c\u0131"};e.timeline.push(n),m(e)}})("cancelled"),children:"\u0130ptal Et"})})]}),(0,E.jsxs)(l.Zp,{className:"p-6",children:[(0,E.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sipari\u015f Cevap Sistemi"}),(0,E.jsx)("div",{className:"space-y-4",children:(0,E.jsxs)("div",{children:[(0,E.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Sipari\u015fe Cevap Ver"}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Durum Se\xe7in"}),(0,E.jsxs)("select",{className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-transparent",value:v,onChange:e=>y(e.target.value),children:[(0,E.jsx)("option",{value:"",children:"Durum se\xe7in..."}),(0,E.jsx)("option",{value:"siparis_kabul_edildi",children:"\u2705 Sipari\u015f Kabul Edildi"}),(0,E.jsx)("option",{value:"siparis_reddedildi",children:"\u274c Sipari\u015f Reddedildi"}),(0,E.jsx)("option",{value:"ek_bilgi_gerekli",children:"\u2139\ufe0f Ek Bilgi Gerekli"}),(0,E.jsx)("option",{value:"teslim_tarihi_de\u011fi\u015fti",children:"\ud83d\udcc5 Teslim Tarihi De\u011fi\u015fti"}),(0,E.jsx)("option",{value:"fiyat_teklifi",children:"\ud83d\udcb0 Fiyat Teklifi"}),(0,E.jsx)("option",{value:"not",children:"\ud83d\udcdd NOT"})]})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"not"===v?"Not (Zorunlu)":"Not (Opsiyonel)"}),(0,E.jsx)("textarea",{className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3",placeholder:"Sipari\u015f hakk\u0131nda notlar\u0131n\u0131z\u0131 yaz\u0131n...",value:j,onChange:e=>b(e.target.value)})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83c\udfa4 Ses Kayd\u0131 (Opsiyonel)"}),(0,E.jsx)(R,{onRecordingComplete:e=>{S(e),L(!0)},onRecordingDelete:()=>{S(null),L(!1)}}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Ses kayd\u0131 ile daha detayl\u0131 a\xe7\u0131klama yapabilirsiniz. Hem yaz\u0131l\u0131 not hem de ses kayd\u0131 g\xf6nderebilirsiniz."})]}),(0,E.jsx)(l.$n,{className:"w-full",variant:"primary",onClick:async()=>{if(v)try{if(k(!0),console.log("\ud83d\udce4 Sending response:",{status:v,note:j,hasVoiceRecording:!!w}),w){const t=new FormData;t.append("status",v),t.append("note",j),t.append("voiceRecording",w,"voice-recording.webm"),console.log("\ud83d\udce4 FormData contents:");for(let[e,r]of t.entries())console.log("  ".concat(e,":"),r);await U.Ay.post("/orders/".concat(e,"/responses"),t,{headers:{"Content-Type":"multipart/form-data"}})}else console.log("\ud83d\udce4 Sending JSON data:",{status:v,note:j}),await U.Ay.post("/orders/".concat(e,"/responses"),{status:v,note:j});y(""),b(""),S(null),L(!1),await z(),await r()}catch(t){console.error("Send response error:",t)}finally{k(!1)}},disabled:!v||N||"not"===v&&!j.trim()&&!A,children:N?"G\xf6nderiliyor...":"Cevab\u0131 G\xf6nder"})]})})]})]})]})]}):(0,E.jsxs)("div",{className:"text-center py-12",children:[(0,E.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Sipari\u015f Bulunamad\u0131"}),(0,E.jsx)("p",{className:"text-gray-600 mb-6",children:"Arad\u0131\u011f\u0131n\u0131z sipari\u015f mevcut de\u011fil."}),(0,E.jsx)(i.N_,{to:"/orders",children:(0,E.jsx)(l.$n,{variant:"primary",children:"Sipari\u015flere D\xf6n"})})]})}}}]);
//# sourceMappingURL=453.4c27afab.chunk.js.map