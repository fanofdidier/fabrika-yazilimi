"use strict";(self.webpackChunkfabrika_magaza_frontend=self.webpackChunkfabrika_magaza_frontend||[]).push([[300],{5919:(e,r,t)=>{t.r(r),t.d(r,{default:()=>u});var a=t(2555),s=t(5043),n=t(3216),l=t(5475),o=t(749),i=t(6305),c=t(579);const d=e=>{let{value:r,onChange:t,placeholder:a="\xdcr\xfcn ad\u0131 yaz\u0131n...",onProductSelect:n,className:l="",error:o=null}=e;const[d,u]=(0,s.useState)([]),[m,p]=(0,s.useState)(!1),[x,h]=(0,s.useState)(!1),[y,g]=(0,s.useState)(-1),b=(0,s.useRef)(null),f=(0,s.useRef)(null),j=(0,s.useRef)(null),v=e=>{t(e.name),h(!1),g(-1),n&&n(e)};return(0,s.useEffect)(()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&b.current&&!b.current.contains(e.target)&&(h(!1),g(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.useEffect)(()=>()=>{j.current&&clearTimeout(j.current)},[]),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("input",{ref:b,type:"text",value:r,onChange:e=>{const r=e.target.value;t(r),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{(async e=>{if(e.length<2)u([]);else{p(!0);try{const r=await i.Ay.get("/products/search?q=".concat(encodeURIComponent(e),"&limit=8"));r.data.success&&u(r.data.data.products)}catch(o){console.error("\xdcr\xfcn arama hatas\u0131:",o),u([])}finally{p(!1)}}})(r)},300),h(!0),g(-1)},onKeyDown:e=>{if(x&&0!==d.length)switch(e.key){case"ArrowDown":e.preventDefault(),g(e=>e<d.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),g(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),y>=0&&y<d.length&&v(d[y]);break;case"Escape":h(!1),g(-1)}},onFocus:()=>h(!0),placeholder:a,className:"\n          w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\n          ".concat(o?"border-red-500":"border-gray-300","\n          ").concat(l,"\n        "),autoComplete:"off"}),m&&(0,c.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,c.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),x&&d.length>0&&(0,c.jsx)("div",{ref:f,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:d.map((e,r)=>(0,c.jsxs)("div",{onClick:()=>v(e),className:"\n                px-3 py-2 cursor-pointer hover:bg-gray-100 flex items-center justify-between\n                ".concat(r===y?"bg-blue-50":"","\n              "),children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,c.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:e.category}),(0,c.jsxs)("span",{className:"text-xs text-blue-600",children:[e.usageCount," kez kullan\u0131ld\u0131"]})]})]},e._id))}),o&&(0,c.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o})]})},u=()=>{const e=(0,n.Zp)(),[r,t]=(0,s.useState)(!1),[u,m]=(0,s.useState)({}),[p,x]=(0,s.useState)({productName:"",productCode:"",priority:"normal",deliveryDate:"",notes:""}),[h,y]=(0,s.useState)(null),g=e=>{const{name:r,value:t}=e.target;x(e=>(0,a.A)((0,a.A)({},e),{},{[r]:t})),u[r]&&m(e=>(0,a.A)((0,a.A)({},e),{},{[r]:""}))};return(0,c.jsxs)("div",{className:"max-w-2xl mx-auto p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Yeni Sipari\u015f Olu\u015ftur"}),(0,c.jsx)("p",{className:"text-gray-600 mt-2",children:"Basit sipari\u015f olu\u015fturma formu"})]}),(0,c.jsx)(l.N_,{to:"/orders",children:(0,c.jsx)(o.$n,{variant:"outline",children:"Geri D\xf6n"})})]}),(0,c.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),(()=>{const e={};if(p.productName.trim()||(e.productName="\xdcr\xfcn ad\u0131 gereklidir"),p.productCode.trim()||(e.productCode="\xdcr\xfcn kodu gereklidir"),p.deliveryDate){const r=new Date(p.deliveryDate),t=new Date;t.setHours(0,0,0,0),r<=t&&(e.deliveryDate="Teslimat tarihi bug\xfcnden sonra olmal\u0131d\u0131r")}else e.deliveryDate="Teslimat tarihi gereklidir";return m(e),0===Object.keys(e).length})()){t(!0);try{!h&&p.productName.trim()&&await i.Ay.post("/products",{name:p.productName.trim(),description:p.notes||"",category:"di\u011fer"});const r={title:p.productName,description:p.notes||"".concat(p.productCode," - ").concat(p.productName),priority:p.priority,dueDate:p.deliveryDate,location:"fabrika",items:[{productName:p.productName,quantity:1,unit:"adet",description:p.notes||"".concat(p.productCode," - ").concat(p.productName),urgency:p.priority}]},t=await i.Ay.post("/orders",r);if(!t.data.success)throw new Error("API response error");console.log("Sipari\u015f ba\u015far\u0131yla olu\u015fturuldu:",t.data.data.order),e("/orders",{state:{message:"Sipari\u015f ba\u015far\u0131yla olu\u015fturuldu!",type:"success"}})}catch(a){console.error("Sipari\u015f olu\u015fturma hatas\u0131:",a),m({submit:"Sipari\u015f olu\u015fturulurken bir hata olu\u015ftu. L\xfctfen tekrar deneyin."})}finally{t(!1)}}},className:"space-y-6",children:[(0,c.jsxs)(o.Zp,{className:"p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"\xdcr\xfcn Bilgileri"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xdcr\xfcn Ad\u0131 *"}),(0,c.jsx)(d,{value:p.productName,onChange:e=>{x(r=>(0,a.A)((0,a.A)({},r),{},{productName:e})),u.productName&&m(e=>(0,a.A)((0,a.A)({},e),{},{productName:""}))},onProductSelect:e=>{y(e),x(r=>(0,a.A)((0,a.A)({},r),{},{productName:e.name}))},placeholder:"\xdcr\xfcn ad\u0131n\u0131 yaz\u0131n (otomatik tamamlama)",error:u.productName}),h&&(0,c.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["\u2713 ",h.usageCount," kez kullan\u0131lan \xfcr\xfcn se\xe7ildi"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xdcr\xfcn Kodu *"}),(0,c.jsx)(o.pd,{name:"productCode",value:p.productCode,onChange:g,placeholder:"\xdcr\xfcn kodunu girin",error:u.productCode})]})]})]}),(0,c.jsxs)(o.Zp,{className:"p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Sipari\u015f Detaylar\u0131"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xd6ncelik"}),(0,c.jsxs)("select",{name:"priority",value:p.priority,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,c.jsx)("option",{value:"d\xfc\u015f\xfck",children:"D\xfc\u015f\xfck"}),(0,c.jsx)("option",{value:"normal",children:"Normal"}),(0,c.jsx)("option",{value:"y\xfcksek",children:"Y\xfcksek"}),(0,c.jsx)("option",{value:"acil",children:"Acil"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teslimat Tarihi *"}),(0,c.jsx)(o.pd,{type:"date",name:"deliveryDate",value:p.deliveryDate,onChange:g,error:u.deliveryDate})]})]}),(0,c.jsxs)("div",{className:"mt-6",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"A\xe7\u0131klama"}),(0,c.jsx)("textarea",{name:"notes",value:p.notes,onChange:g,placeholder:"Sipari\u015f a\xe7\u0131klamas\u0131 (opsiyonel)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]})]}),u.submit&&(0,c.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,c.jsx)("p",{className:"text-red-600",children:u.submit})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,c.jsx)(l.N_,{to:"/orders",children:(0,c.jsx)(o.$n,{type:"button",variant:"outline",children:"\u0130ptal"})}),(0,c.jsx)(o.$n,{type:"submit",variant:"primary",disabled:r,children:r?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.kt,{size:"sm",className:"mr-2"}),"Sipari\u015f Olu\u015fturuluyor..."]}):"Sipari\u015f Olu\u015ftur"})]})]})]})}}}]);
//# sourceMappingURL=300.bf86d14d.chunk.js.map